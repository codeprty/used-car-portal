<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Car Listings</title>
</head>
<body>
    <h1>Available Cars</h1>
    
    <table border="1">
        <tr>
            <th>Make</th>
            <th>Model</th>
            <th>Year</th>
            <th>Price</th>
            <th>Image</th>
            <th>Actions</th>
        </tr>
        <tr th:each="car : ${cars}">
            <td th:text="${car.make}"></td>
            <td th:text="${car.model}"></td>
            <td th:text="${car.year}"></td>
            <td th:text="${car.price}"></td>
            <td>
                <img th:src="${car.imageUrl}" alt="Car Image" width="100">
            </td>
            <td>
   		 		<!-- Regular user: Show Edit and Deactivate buttons -->
    			<div th:if="${#authentication.name == car.postedBy}">
        			<a th:href="@{/edit-car/{id}(id=${car.id})}">Edit</a>
        				<form th:action="@{/deactivate-car/{id}(id=${car.id})}" method="post" style="display:inline;">
            				<button type="submit">Deactivate</button>
        				</form>
    			</div>

    			<!-- Admin: Show Delete button -->
    			<div th:if="${#authorization.expression('hasRole(''ADMIN'')')}">
        			<form th:action="@{/admin/delete-car/{id}(id=${car.id})}" method="post">
            			<button type="submit">Delete</button>
        			</form>
    			</div>
			</td>
        </tr>
    </table>

    <a href="/home">Back to Home</a>
</body>
</html>
